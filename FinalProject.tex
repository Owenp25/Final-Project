% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={ProjectDraft},
  pdfauthor={Cam Lunn, Atticus Patrick, \& Owen Patrick},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{ProjectDraft}
\author{Cam Lunn, Atticus Patrick, \& Owen Patrick}
\date{4/18/2022}

\begin{document}
\maketitle

Name Description Levels ------- -------------- -----------

Age Age of the patient Sex Sex of the patient exang exercise induced
angina (1 = yes; 0 = no) caa number of major vessels (0-3) cp Chest Pain
type chest pain type Value 1: typical angina {[}TA{]} Value 2: atypical
angina {[}ATA{]} ` Value 3: non-anginal pain {[}NAP{]} Value 4:
asymptomatic {[}ASY{]}

trtbps resting blood pressure (in mm Hg) chol cholestoral in mg/dl
fetched via BMI sensor fbs (fasting blood sugar \textgreater{} 120
mg/dl) (1 = true; 0 = false) rest\_ecg resting electrocardiographic
Value 0: normal results Value 1: having ST-T wave abnormality (T wave
inversions and/or ST elevation or depression of \textgreater{} 0.05
mV)\\
Value 2: showing probable or definite left ventricular hypertrophy by
Estes' criteria

thalach ` maximum heart rate achieved target chance of a heart attack 0=
less chance of heart attack; 1= more chance of heart attack

HEART2:
\url{https://www.kaggle.com/datasets/fedesoriano/heart-failure-prediction}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Combined 5 datasets (Cleveland, Long Beach, Switzerland, Hungarian, \& Stalog)}
\NormalTok{skimr}\SpecialCharTok{::}\FunctionTok{skim}\NormalTok{(heart)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}ll@{}}
\caption{Data summary}\tabularnewline
\toprule
\endhead
Name & heart \\
Number of rows & 918 \\
Number of columns & 12 \\
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ & \\
Column type frequency: & \\
character & 6 \\
factor & 1 \\
numeric & 5 \\
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ & \\
Group variables & None \\
\bottomrule
\end{longtable}

\textbf{Variable type: character}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.2055}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.1370}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.1918}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.0548}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.0548}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.0822}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.1233}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 14\tabcolsep) * \real{0.1507}}@{}}
\toprule
\begin{minipage}[b]{\linewidth}\raggedright
skim\_variable
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
n\_missing
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
complete\_rate
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
min
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
max
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
empty
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
n\_unique
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
whitespace
\end{minipage} \\
\midrule
\endhead
Age & 0 & 1 & 5 & 5 & 0 & 5 & 0 \\
Sex & 0 & 1 & 1 & 1 & 0 & 2 & 0 \\
ChestPainType & 0 & 1 & 2 & 3 & 0 & 4 & 0 \\
RestingECG & 0 & 1 & 2 & 6 & 0 & 3 & 0 \\
ExerciseAngina & 0 & 1 & 1 & 1 & 0 & 2 & 0 \\
ST\_Slope & 0 & 1 & 2 & 4 & 0 & 3 & 0 \\
\bottomrule
\end{longtable}

\textbf{Variable type: factor}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1892}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1351}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1892}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1081}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.1216}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 10\tabcolsep) * \real{0.2568}}@{}}
\toprule
\begin{minipage}[b]{\linewidth}\raggedright
skim\_variable
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
n\_missing
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
complete\_rate
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
ordered
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
n\_unique
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
top\_counts
\end{minipage} \\
\midrule
\endhead
HeartDisease & 0 & 1 & FALSE & 2 & Aff: 508, Una: 410 \\
\bottomrule
\end{longtable}

\textbf{Variable type: numeric}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.1138}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0813}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.1138}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0569}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0569}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0407}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0569}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0488}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0488}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.0488}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 20\tabcolsep) * \real{0.3333}}@{}}
\toprule
\begin{minipage}[b]{\linewidth}\raggedright
skim\_variable
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
n\_missing
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
complete\_rate
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
mean
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
sd
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p0
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p25
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p50
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p75
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p100
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
hist
\end{minipage} \\
\midrule
\endhead
RestingBP & 0 & 1 & 132.40 & 18.51 & 0.0 & 120.00 & 130.0 & 140.0 &
200.0 & ▁▁▃▇▁ \\
Cholesterol & 0 & 1 & 198.80 & 109.38 & 0.0 & 173.25 & 223.0 & 267.0 &
603.0 & ▃▇▇▁▁ \\
FastingBS & 0 & 1 & 0.23 & 0.42 & 0.0 & 0.00 & 0.0 & 0.0 & 1.0 &
▇▁▁▁▂ \\
MaxHR & 0 & 1 & 136.81 & 25.46 & 60.0 & 120.00 & 138.0 & 156.0 & 202.0 &
▁▃▇▆▂ \\
Oldpeak & 0 & 1 & 0.89 & 1.07 & -2.6 & 0.00 & 0.6 & 1.5 & 6.2 & ▁▇▆▁▁ \\
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{R }\OtherTok{\textless{}{-}} \FunctionTok{cor}\NormalTok{(heart }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(}\FunctionTok{where}\NormalTok{(is.numeric)))}

\FunctionTok{corrplot}\NormalTok{(R, }
        \AttributeTok{method=}\StringTok{"shade"}\NormalTok{, }
        \AttributeTok{type=}\StringTok{"upper"}\NormalTok{, }
        \AttributeTok{addCoef.col =} \StringTok{"yellow"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{FinalProject_files/figure-latex/Exploratory-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{heart }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{c}\NormalTok{(RestingBP, Cholesterol, Oldpeak, MaxHR),}
               \AttributeTok{names\_to =} \StringTok{"attribute"}\NormalTok{,}
               \AttributeTok{values\_to =} \StringTok{"value"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  
  \FunctionTok{ggplot}\NormalTok{(}\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ value,}
                       \AttributeTok{fill =}\NormalTok{ ChestPainType)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{facet\_wrap}\NormalTok{(}\AttributeTok{facets =} \SpecialCharTok{\textasciitilde{}}\NormalTok{ attribute,}
             \AttributeTok{scales =} \StringTok{"free"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{fill =} \StringTok{"ChestPainType"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"top"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{FinalProject_files/figure-latex/Exploratory-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{heart }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{c}\NormalTok{(RestingBP, Cholesterol, Oldpeak, MaxHR),}
               \AttributeTok{names\_to =} \StringTok{"attribute"}\NormalTok{,}
               \AttributeTok{values\_to =} \StringTok{"value"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  
  \FunctionTok{ggplot}\NormalTok{(}\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ value,}
                       \AttributeTok{fill =}\NormalTok{ HeartDisease)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{alpha =}\NormalTok{ .}\DecValTok{5}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{facet\_wrap}\NormalTok{(}\AttributeTok{facets =} \SpecialCharTok{\textasciitilde{}}\NormalTok{ attribute,}
             \AttributeTok{scales =} \StringTok{"free"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{fill =} \StringTok{"HeartDisease"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"top"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{FinalProject_files/figure-latex/Exploratory-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{table}\NormalTok{(heart}\SpecialCharTok{$}\NormalTok{Sex)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##   F   M 
## 193 725
\end{verbatim}

\hypertarget{check-some-group-means}{%
\subsection{Check some group means}\label{check-some-group-means}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{HD\_means }\OtherTok{\textless{}{-}}
\NormalTok{  heart }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(HeartDisease, Age) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\AttributeTok{.cols =} \FunctionTok{c}\NormalTok{(Cholesterol, Oldpeak, MaxHR),}
                   \AttributeTok{.fns =}\NormalTok{ mean))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'HeartDisease'. You can override using the
## `.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{view}\NormalTok{(HD\_means)}
\end{Highlighting}
\end{Shaded}

\hypertarget{pca-to-check-significance-of-variables}{%
\subsection{PCA to Check Significance of
Variables}\label{pca-to-check-significance-of-variables}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(heart\_R\_PCA }\OtherTok{\textless{}{-}} \FunctionTok{prcomp}\NormalTok{(heart }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(}\FunctionTok{where}\NormalTok{(is.numeric)),}
                      \AttributeTok{scale. =}\NormalTok{ T))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Standard deviations (1, .., p=5):
## [1] 1.2065604 1.1097962 0.9388502 0.8981496 0.7902227
## 
## Rotation (n x k) = (5 x 5):
##                    PC1        PC2         PC3         PC4        PC5
## RestingBP   -0.2081438  0.6200490 -0.50283439  0.47498599 -0.3062048
## Cholesterol  0.5213448  0.4907686 -0.09691372 -0.07149774  0.6876348
## FastingBS   -0.5280012 -0.1762990 -0.61339632 -0.39352023  0.3987733
## MaxHR        0.5721234 -0.1010971 -0.48932536 -0.44257379 -0.4765955
## Oldpeak     -0.2806515  0.5773937  0.34938655 -0.64695182 -0.2173330
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(heart\_R\_PCA)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Importance of components:
##                           PC1    PC2    PC3    PC4    PC5
## Standard deviation     1.2066 1.1098 0.9389 0.8981 0.7902
## Proportion of Variance 0.2912 0.2463 0.1763 0.1613 0.1249
## Cumulative Proportion  0.2912 0.5375 0.7138 0.8751 1.0000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fviz\_screeplot}\NormalTok{(}\AttributeTok{X =}\NormalTok{ heart\_R\_PCA,}
               \AttributeTok{choice =} \StringTok{"eigenvalue"}\NormalTok{,}
               \AttributeTok{geom =} \StringTok{"line"}\NormalTok{,}
               \AttributeTok{linecolor =} \StringTok{"steelblue"}\NormalTok{,}
               \AttributeTok{ncp =}\NormalTok{ p) }\SpecialCharTok{+} 
  
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Screeplot using the Covariance Matrix"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"Principal Component"}\NormalTok{) }\SpecialCharTok{+} 
  
  \FunctionTok{geom\_hline}\NormalTok{(}\AttributeTok{yintercept =} \DecValTok{1}\NormalTok{,}
             \AttributeTok{color =} \StringTok{"darkred"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{FinalProject_files/figure-latex/PCA-1.pdf}

\hypertarget{c-correlation-matrix-pca-biplot}{%
\paragraph{2c: Correlation Matrix PCA
Biplot}\label{c-correlation-matrix-pca-biplot}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fviz\_pca}\NormalTok{(}\AttributeTok{X =}\NormalTok{ heart\_R\_PCA,}
         \AttributeTok{axes =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{),              }\CommentTok{\# Which PCs to plot}
         \AttributeTok{geom =} \FunctionTok{c}\NormalTok{(}\StringTok{"point"}\NormalTok{), }
         \AttributeTok{alpha.ind =}\NormalTok{ .}\DecValTok{1}\NormalTok{, }
         \AttributeTok{repel =}\NormalTok{ T)  }\SpecialCharTok{+}   \CommentTok{\# text adds name of country.}

  \FunctionTok{coord\_equal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{FinalProject_files/figure-latex/2c_biplot-1.pdf}

\hypertarget{check-differences-using-manova}{%
\subsection{Check Differences Using
MANOVA}\label{check-differences-using-manova}}

\begin{verbatim}
##                Df Pillai approx F num Df den Df    Pr(>F)    
## ChestPainType   3 0.3506   20.092     18   2733 < 2.2e-16 ***
## Residuals     914                                            
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\hypertarget{check-assumptions}{%
\subsection{Check Assumptions}\label{check-assumptions}}

\includegraphics{FinalProject_files/figure-latex/Assumptions-1.pdf}

\begin{verbatim}
## $multivariateNormality
##              Test        Statistic              p value Result
## 1 Mardia Skewness 589.108111990132 5.60870103553026e-90     NO
## 2 Mardia Kurtosis 10.9939764879178                    0     NO
## 3             MVN             <NA>                 <NA>     NO
## 
## $univariateNormality
##           Test     Variable Statistic   p value Normality
## 1 Shapiro-Wilk  RestingBP      0.9640  <0.001      NO    
## 2 Shapiro-Wilk Cholesterol     0.9037  <0.001      NO    
## 3 Shapiro-Wilk  FastingBS      0.6462  <0.001      NO    
## 4 Shapiro-Wilk    MaxHR        0.9950  0.0041      NO    
## 5 Shapiro-Wilk   Oldpeak       0.9354  <0.001      NO    
## 6 Shapiro-Wilk HeartDisease    0.9078  <0.001      NO
\end{verbatim}

\begin{verbatim}
## # A tibble: 1 x 4
##   statistic  p.value parameter method                                           
##       <dbl>    <dbl>     <dbl> <chr>                                            
## 1      214. 8.59e-24        45 Box's M-test for Homogeneity of Covariance Matri~
\end{verbatim}

\hypertarget{lets-see-whats-actually-useful}{%
\subsection{Let's see what's actually
useful:}\label{lets-see-whats-actually-useful}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{Partial\_F}\NormalTok{(}\AttributeTok{Y =}\NormalTok{ heart\_CP }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{              dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(}\FunctionTok{where}\NormalTok{(is.numeric)),}
          \AttributeTok{x =}\NormalTok{ heart\_CP}\SpecialCharTok{$}\NormalTok{ChestPainType)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              Partial_Test     F_stat P_value
## FastingBS       0.6584917  0.7256171  0.5368
## RestingBP       0.6594567  1.1707212  0.3198
## Cholesterol     0.6606126  1.7038807  0.1646
## Oldpeak         0.6719081  6.9138243  0.0001
## MaxHR           0.6846037 12.7696034  0.0000
## HeartDisease    0.7735874 53.8128436  0.0000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{Partial\_F}\NormalTok{(}\AttributeTok{Y =}\NormalTok{ heart\_CP }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{              dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(FastingBS, RestingBP, Cholesterol, Oldpeak, MaxHR, HeartDisease), }
          \AttributeTok{x =}\NormalTok{ heart\_CP}\SpecialCharTok{$}\NormalTok{ChestPainType)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              Partial_Test     F_stat P_value
## FastingBS       0.6584917  0.7256171  0.5368
## RestingBP       0.6594567  1.1707212  0.3198
## Cholesterol     0.6606126  1.7038807  0.1646
## Oldpeak         0.6719081  6.9138243  0.0001
## MaxHR           0.6846037 12.7696034  0.0000
## HeartDisease    0.7735874 53.8128436  0.0000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{heart\_man }\OtherTok{\textless{}{-}} \FunctionTok{manova}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(FastingBS, RestingBP, Cholesterol, Oldpeak, MaxHR, HeartDisease) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ChestPainType,}
    \AttributeTok{data =}\NormalTok{ heart\_CP)}

\FunctionTok{summary}\NormalTok{(heart\_man)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                Df Pillai approx F num Df den Df    Pr(>F)    
## ChestPainType   3 0.3506   20.092     18   2733 < 2.2e-16 ***
## Residuals     914                                            
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \# }
\FunctionTok{Partial\_F}\NormalTok{(}\AttributeTok{Y =}\NormalTok{ heart\_CP }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{              dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(RestingBP, Cholesterol, Oldpeak, MaxHR, HeartDisease), }
          \AttributeTok{x =}\NormalTok{ heart\_CP}\SpecialCharTok{$}\NormalTok{ChestPainType)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              Partial_Test    F_stat P_value
## RestingBP       0.6612433  1.267504  0.2843
## Cholesterol     0.6630763  2.111879  0.0972
## Oldpeak         0.6732557  6.801000  0.0002
## MaxHR           0.6862712 12.796601  0.0000
## HeartDisease    0.7814023 56.618608  0.0000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{heart\_man }\OtherTok{\textless{}{-}} \FunctionTok{manova}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(RestingBP, Cholesterol, Oldpeak, MaxHR, HeartDisease) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ChestPainType,}
    \AttributeTok{data =}\NormalTok{ heart\_CP)}

\FunctionTok{summary}\NormalTok{(heart\_man)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                Df  Pillai approx F num Df den Df    Pr(>F)    
## ChestPainType   3 0.34829   23.957     15   2736 < 2.2e-16 ***
## Residuals     914                                             
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \# }

\FunctionTok{Partial\_F}\NormalTok{(}\AttributeTok{Y =}\NormalTok{ heart\_CP }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{              dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(Cholesterol, Oldpeak, MaxHR, HeartDisease), }
          \AttributeTok{x =}\NormalTok{ heart\_CP}\SpecialCharTok{$}\NormalTok{ChestPainType)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              Partial_Test    F_stat P_value
## Cholesterol     0.6658167  2.100288  0.0986
## Oldpeak         0.6762186  6.877206  0.0001
## MaxHR           0.6880401 12.306053  0.0000
## HeartDisease    0.7840135 56.380493  0.0000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{heart\_man }\OtherTok{\textless{}{-}} \FunctionTok{manova}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(Cholesterol, Oldpeak, MaxHR, HeartDisease) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ChestPainType,}
    \AttributeTok{data =}\NormalTok{ heart\_CP)}

\FunctionTok{summary}\NormalTok{(heart\_man)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                Df  Pillai approx F num Df den Df    Pr(>F)    
## ChestPainType   3 0.34449    29.61     12   2739 < 2.2e-16 ***
## Residuals     914                                             
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \# }



\FunctionTok{Partial\_F}\NormalTok{(}\AttributeTok{Y =}\NormalTok{ heart\_CP }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{              dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(Oldpeak, MaxHR, HeartDisease), }
          \AttributeTok{x =}\NormalTok{ heart\_CP}\SpecialCharTok{$}\NormalTok{ChestPainType)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              Partial_Test    F_stat P_value
## Oldpeak         0.6799320  6.444781   3e-04
## MaxHR           0.6935460 12.660708   0e+00
## HeartDisease    0.7959784 59.429485   0e+00
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{heart\_man }\OtherTok{\textless{}{-}} \FunctionTok{manova}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(Oldpeak, MaxHR, HeartDisease) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ChestPainType,}
    \AttributeTok{data =}\NormalTok{ heart\_CP)}

\FunctionTok{summary}\NormalTok{(heart\_man)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                Df Pillai approx F num Df den Df    Pr(>F)    
## ChestPainType   3 0.3377   38.645      9   2742 < 2.2e-16 ***
## Residuals     914                                            
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \# }


\FunctionTok{Partial\_F}\NormalTok{(}\AttributeTok{Y =}\NormalTok{ heart\_CP }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{              dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(MaxHR, HeartDisease), }
          \AttributeTok{x =}\NormalTok{ heart\_CP}\SpecialCharTok{$}\NormalTok{ChestPainType)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              Partial_Test   F_stat P_value
## HeartDisease     47.05307 20756.33       0
## MaxHR           125.66093 55940.72       0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{heart\_man }\OtherTok{\textless{}{-}} \FunctionTok{manova}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(MaxHR, HeartDisease) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ChestPainType,}
    \AttributeTok{data =}\NormalTok{ heart\_CP)}

\FunctionTok{summary}\NormalTok{(heart\_man)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                Df  Pillai approx F num Df den Df    Pr(>F)    
## ChestPainType   3 0.32149   58.354      6   1828 < 2.2e-16 ***
## Residuals     914                                             
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \# }

\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}CHECKING HEART DISEASE AS OUTCOME {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}\# }

\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \# }
\FunctionTok{Partial\_F}\NormalTok{(}\AttributeTok{Y =}\NormalTok{ heart }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{              dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(RestingBP, Cholesterol, Oldpeak, MaxHR), }
          \AttributeTok{x =}\NormalTok{ heart}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             Partial_Test     F_stat P_value
## RestingBP      0.6907685   1.434188  0.2314
## Cholesterol    0.7211359  41.634334  0.0000
## MaxHR          0.7683385 104.120706  0.0000
## Oldpeak        0.8125844 162.693164  0.0000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{heart\_man }\OtherTok{\textless{}{-}} \FunctionTok{manova}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(RestingBP, Cholesterol, Oldpeak, MaxHR) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ HeartDisease,}
    \AttributeTok{data =}\NormalTok{ heart)}

\FunctionTok{summary}\NormalTok{(heart\_man)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##               Df  Pillai approx F num Df den Df    Pr(>F)    
## HeartDisease   1 0.31032    102.7      4    913 < 2.2e-16 ***
## Residuals    916                                             
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \# }
\FunctionTok{Partial\_F}\NormalTok{(}\AttributeTok{Y =}\NormalTok{ heart }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{              dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(Cholesterol, Oldpeak, MaxHR), }
          \AttributeTok{x =}\NormalTok{ heart}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             Partial_Test    F_stat P_value
## Cholesterol    0.7212734  40.36289       0
## MaxHR          0.7726544 108.34848       0
## Oldpeak        0.8194031 170.20465       0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{heart\_man }\OtherTok{\textless{}{-}} \FunctionTok{manova}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(Cholesterol, Oldpeak, MaxHR) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ HeartDisease,}
    \AttributeTok{data =}\NormalTok{ heart)}

\FunctionTok{summary}\NormalTok{(heart\_man)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##               Df  Pillai approx F num Df den Df    Pr(>F)    
## HeartDisease   1 0.30923   136.39      3    914 < 2.2e-16 ***
## Residuals    916                                             
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Stratify by ChestPain Type:}
\NormalTok{heart\_man }\OtherTok{\textless{}{-}} \FunctionTok{manova}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(Cholesterol, Oldpeak, MaxHR) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ChestPainType }\SpecialCharTok{+}\NormalTok{ HeartDisease,}
    \AttributeTok{data =}\NormalTok{ heart)}

\FunctionTok{summary}\NormalTok{(heart\_man)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                Df  Pillai approx F num Df den Df    Pr(>F)    
## ChestPainType   3 0.25093   27.779      9   2739 < 2.2e-16 ***
## HeartDisease    1 0.17711   65.356      3    911 < 2.2e-16 ***
## Residuals     913                                             
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Age, Sex, RestingBP, Cholesterol, FastingBS, RestingECG, MaxHR, ExerciseAngina, Oldpeak, ST\_Slope, HeartDisease}
\end{Highlighting}
\end{Shaded}

\includegraphics{FinalProject_files/figure-latex/Linear Discriminate-1.pdf}
\includegraphics{FinalProject_files/figure-latex/Linear Discriminate-2.pdf}

\hypertarget{qda-predicting-for-heart-disease-outcome}{%
\section{QDA Predicting for Heart Disease
Outcome}\label{qda-predicting-for-heart-disease-outcome}}

\includegraphics{FinalProject_files/figure-latex/Assumptions HEART DISEASE-1.pdf}

\begin{verbatim}
## $multivariateNormality
##              Test        Statistic              p value Result
## 1 Mardia Skewness 148.731699425912 6.79634995118435e-27     NO
## 2 Mardia Kurtosis 5.96290087467747 2.47798759289708e-09     NO
## 3             MVN             <NA>                 <NA>     NO
## 
## $univariateNormality
##           Test    Variable Statistic   p value Normality
## 1 Shapiro-Wilk Cholesterol    0.9348  <0.001      NO    
## 2 Shapiro-Wilk   Oldpeak      0.9515  <0.001      NO    
## 3 Shapiro-Wilk    MaxHR       0.9951  0.0046      NO
\end{verbatim}

\begin{verbatim}
## # A tibble: 1 x 4
##   statistic  p.value parameter method                                           
##       <dbl>    <dbl>     <dbl> <chr>                                            
## 1      219. 1.66e-44         6 Box's M-test for Homogeneity of Covariance Matri~
\end{verbatim}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##             actual
## predicted    Affected Unaffected
##   Affected        379         84
##   Unaffected      129        326
##                                           
##                Accuracy : 0.768           
##                  95% CI : (0.7393, 0.7949)
##     No Information Rate : 0.5534          
##     P-Value [Acc > NIR] : < 2.2e-16       
##                                           
##                   Kappa : 0.5355          
##                                           
##  Mcnemar's Test P-Value : 0.002571        
##                                           
##             Sensitivity : 0.7461          
##             Specificity : 0.7951          
##          Pos Pred Value : 0.8186          
##          Neg Pred Value : 0.7165          
##              Prevalence : 0.5534          
##          Detection Rate : 0.4129          
##    Detection Prevalence : 0.5044          
##       Balanced Accuracy : 0.7706          
##                                           
##        'Positive' Class : Affected        
## 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Find the pooled standard deviations:}
\NormalTok{sd\_heart\_HD }\OtherTok{\textless{}{-}} 
  \FunctionTok{summary}\NormalTok{(heart\_man)}\SpecialCharTok{$}\NormalTok{SS}\SpecialCharTok{$}\NormalTok{Residuals }\SpecialCharTok{\%\textgreater{}\%}  
  \FunctionTok{diag}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{sqrt}\NormalTok{()}\SpecialCharTok{/}\FunctionTok{sqrt}\NormalTok{(N}\SpecialCharTok{{-}}\NormalTok{k\_HD)}



\CommentTok{\# Standardize the data using the pooled standard deviations:}


\CommentTok{\# Now we need to divide each variable by the pooled sd:}
\NormalTok{heart\_sc\_HD }\OtherTok{\textless{}{-}} 
  \FunctionTok{scale}\NormalTok{(heart[, }\FunctionTok{c}\NormalTok{(}\StringTok{"Cholesterol"}\NormalTok{, }\StringTok{"Oldpeak"}\NormalTok{, }\StringTok{"MaxHR"}\NormalTok{)],}
        \AttributeTok{center =}\NormalTok{ T, }
        \AttributeTok{scale =}\NormalTok{ sd\_heart\_HD) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{data.frame}\NormalTok{()}


\NormalTok{heart\_sc\_HD}\SpecialCharTok{$}\NormalTok{HeartDisease }\OtherTok{\textless{}{-}}\NormalTok{ heart}\SpecialCharTok{$}\NormalTok{HeartDisease}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##          actual
## predicted  TA ATA NAP ASY
##       TA    0   0   2   1
##       ATA  15 136 103  76
##       NAP   5  12  18   9
##       ASY  26  25  80 410
## 
## Overall Statistics
##                                         
##                Accuracy : 0.6144        
##                  95% CI : (0.582, 0.646)
##     No Information Rate : 0.5403        
##     P-Value [Acc > NIR] : 3.475e-06     
##                                         
##                   Kappa : 0.3606        
##                                         
##  Mcnemar's Test P-Value : < 2.2e-16     
## 
## Statistics by Class:
## 
##                      Class: TA Class: ATA Class: NAP Class: ASY
## Sensitivity           0.000000     0.7861    0.08867     0.8266
## Specificity           0.996560     0.7396    0.96364     0.6896
## Pos Pred Value        0.000000     0.4121    0.40909     0.7579
## Neg Pred Value        0.949727     0.9371    0.78833     0.7719
## Prevalence            0.050109     0.1885    0.22113     0.5403
## Detection Rate        0.000000     0.1481    0.01961     0.4466
## Detection Prevalence  0.003268     0.3595    0.04793     0.5893
## Balanced Accuracy     0.498280     0.7629    0.52615     0.7581
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Make Manova model:}

\NormalTok{heart\_man\_CP }\OtherTok{\textless{}{-}} \FunctionTok{manova}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(Oldpeak, MaxHR, HeartDisease) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ChestPainType,}
    \AttributeTok{data =}\NormalTok{ heart\_CP)}

\CommentTok{\# Find the pooled standard deviations:}
\NormalTok{sd\_heart\_CP }\OtherTok{\textless{}{-}} 
  \FunctionTok{summary}\NormalTok{(heart\_man\_CP)}\SpecialCharTok{$}\NormalTok{SS}\SpecialCharTok{$}\NormalTok{Residuals }\SpecialCharTok{\%\textgreater{}\%}  
  \FunctionTok{diag}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{sqrt}\NormalTok{()}\SpecialCharTok{/}\FunctionTok{sqrt}\NormalTok{(N}\SpecialCharTok{{-}}\NormalTok{k\_pain)}



\CommentTok{\# Standardize the data using the pooled standard deviations:}

\FunctionTok{typeof}\NormalTok{(heart\_CP}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "integer"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Now we need to divide each variable by the pooled sd:}
\NormalTok{heart\_sc\_CP }\OtherTok{\textless{}{-}} 
  \FunctionTok{scale}\NormalTok{(heart\_CP[, }\FunctionTok{c}\NormalTok{(}\StringTok{"Oldpeak"}\NormalTok{, }\StringTok{"MaxHR"}\NormalTok{, }\StringTok{"HeartDisease"}\NormalTok{)],}
        \AttributeTok{center =}\NormalTok{ T, }
        \AttributeTok{scale =}\NormalTok{ sd\_heart\_CP) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{data.frame}\NormalTok{()}

\NormalTok{heart\_sc\_CP}\SpecialCharTok{$}\NormalTok{ChestPainType }\OtherTok{\textless{}{-}}\NormalTok{ heart\_CP}\SpecialCharTok{$}\NormalTok{ChestPainType}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Creating a loop to find the best choice for k}
\FunctionTok{RNGversion}\NormalTok{(}\StringTok{"4.0.0"}\NormalTok{)}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} CHEST PAIN {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}
\FunctionTok{sqrt}\NormalTok{(N}\SpecialCharTok{/}\NormalTok{k\_pain)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 15.14926
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{k\_choice }\OtherTok{\textless{}{-}}\DecValTok{5}\SpecialCharTok{:}\DecValTok{27}

\CommentTok{\# data.frame to store the predictions for different choices of k}
\NormalTok{knn\_predictions }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Actual =}\NormalTok{ heart\_CP}\SpecialCharTok{$}\NormalTok{ChestPainType)}


\CommentTok{\# Function knn.cv() performs KNN using cross{-}validation}
\CommentTok{\# and returns the predicted class based on the nearest neighbors.}

\CommentTok{\# Looping through the different choices of k for knn}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in}\NormalTok{ k\_choice)\{}

\NormalTok{  knn\_temp }\OtherTok{\textless{}{-}}\NormalTok{ class}\SpecialCharTok{::}\FunctionTok{knn.cv}\NormalTok{(}\AttributeTok{train =}\NormalTok{ heart\_sc\_CP }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{ChestPainType),}
                            \AttributeTok{cl =}\NormalTok{ heart\_sc\_CP}\SpecialCharTok{$}\NormalTok{ChestPainType,}
                            \AttributeTok{k =}\NormalTok{ i)}

  \CommentTok{\# adding the predicted column to the data set}
\NormalTok{  knn\_predictions }\OtherTok{\textless{}{-}}
\NormalTok{    knn\_predictions }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{add\_column}\NormalTok{(knn\_temp)}
\NormalTok{\}}

\CommentTok{\# Changing the column names to better describe the results}
\FunctionTok{colnames}\NormalTok{(knn\_predictions) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Actual\textquotesingle{}}\NormalTok{, }\FunctionTok{paste0}\NormalTok{(}\StringTok{"k"}\NormalTok{, k\_choice))}

\CommentTok{\# Calculating the error rate for each choice of k:}
\NormalTok{knn\_predictions }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{starts\_with}\NormalTok{(}\StringTok{"k"}\NormalTok{),}
               \AttributeTok{names\_to =} \StringTok{"k\_choice"}\NormalTok{,}
               \AttributeTok{values\_to =} \StringTok{"prediction"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(k\_choice) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{incorrect =} \FunctionTok{sum}\NormalTok{(Actual }\SpecialCharTok{!=}\NormalTok{ prediction),}
            \AttributeTok{positive\_rate =} \FunctionTok{mean}\NormalTok{(Actual }\SpecialCharTok{==}\NormalTok{ prediction)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{k =} \FunctionTok{parse\_number}\NormalTok{(k\_choice)) }\SpecialCharTok{\%\textgreater{}\%}

  \FunctionTok{ggplot}\NormalTok{(}\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ k,}
                       \AttributeTok{y =}\NormalTok{ positive\_rate)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{color =} \StringTok{"darkred"}\NormalTok{,}
            \AttributeTok{size =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}

  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Choice of k"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Correct Prediction Percentage"}\NormalTok{) }\SpecialCharTok{+}

  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =}\NormalTok{ k\_choice) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{labels =}\NormalTok{ scales}\SpecialCharTok{::}\NormalTok{percent)}
\end{Highlighting}
\end{Shaded}

\includegraphics{FinalProject_files/figure-latex/1eii_kChoice-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# k = 15?}

\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} HEART DISEASE {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}
\FunctionTok{sqrt}\NormalTok{(N}\SpecialCharTok{/}\NormalTok{k\_HD)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 21.42429
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{k\_choice }\OtherTok{\textless{}{-}}\DecValTok{11}\SpecialCharTok{:}\DecValTok{33}

\CommentTok{\# data.frame to store the predictions for different choices of k}
\NormalTok{knn\_predictions }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Actual =}\NormalTok{ heart}\SpecialCharTok{$}\NormalTok{HeartDisease)}


\CommentTok{\# Function knn.cv() performs KNN using cross{-}validation}
\CommentTok{\# and returns the predicted class based on the nearest neighbors.}

\CommentTok{\# Looping through the different choices of k for knn}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in}\NormalTok{ k\_choice)\{}
  
\NormalTok{  knn\_temp }\OtherTok{\textless{}{-}}\NormalTok{ class}\SpecialCharTok{::}\FunctionTok{knn.cv}\NormalTok{(}\AttributeTok{train =}\NormalTok{ heart\_sc\_HD }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{HeartDisease), }
                            \AttributeTok{cl =}\NormalTok{ heart\_sc\_HD}\SpecialCharTok{$}\NormalTok{HeartDisease, }
                            \AttributeTok{k =}\NormalTok{ i)}
  
  \CommentTok{\# adding the predicted column to the data set}
\NormalTok{  knn\_predictions }\OtherTok{\textless{}{-}} 
\NormalTok{    knn\_predictions }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{add\_column}\NormalTok{(knn\_temp)}
\NormalTok{\}}

\CommentTok{\# Changing the column names to better describe the results}
\FunctionTok{colnames}\NormalTok{(knn\_predictions) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Actual\textquotesingle{}}\NormalTok{, }\FunctionTok{paste0}\NormalTok{(}\StringTok{"k"}\NormalTok{, k\_choice))}

\CommentTok{\# Calculating the error rate for each choice of k:}
\NormalTok{knn\_predictions }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{starts\_with}\NormalTok{(}\StringTok{"k"}\NormalTok{),}
               \AttributeTok{names\_to =} \StringTok{"k\_choice"}\NormalTok{,}
               \AttributeTok{values\_to =} \StringTok{"prediction"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(k\_choice) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{incorrect =} \FunctionTok{sum}\NormalTok{(Actual }\SpecialCharTok{!=}\NormalTok{ prediction),}
            \AttributeTok{positive\_rate =} \FunctionTok{mean}\NormalTok{(Actual }\SpecialCharTok{==}\NormalTok{ prediction)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{k =} \FunctionTok{parse\_number}\NormalTok{(k\_choice)) }\SpecialCharTok{\%\textgreater{}\%} 
  
  \FunctionTok{ggplot}\NormalTok{(}\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ k,}
                       \AttributeTok{y =}\NormalTok{ positive\_rate)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{color =} \StringTok{"darkred"}\NormalTok{,}
            \AttributeTok{size =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+} 
  
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Choice of k"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Correct Prediction Percentage"}\NormalTok{) }\SpecialCharTok{+}
  
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =}\NormalTok{ k\_choice) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{labels =}\NormalTok{ scales}\SpecialCharTok{::}\NormalTok{percent)}
\end{Highlighting}
\end{Shaded}

\includegraphics{FinalProject_files/figure-latex/1eii_kChoice-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# k = 19?}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} CHEST PAIN {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \# }
\CommentTok{\# \# Best choice of kNN model}
\NormalTok{heart\_knn }\OtherTok{\textless{}{-}} \FunctionTok{knn.cv}\NormalTok{(}\AttributeTok{train =}\NormalTok{ heart\_sc\_CP}\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{ChestPainType),}
                          \AttributeTok{cl =}\NormalTok{ heart\_sc\_CP}\SpecialCharTok{$}\NormalTok{ChestPainType,}
                          \AttributeTok{k =} \DecValTok{15}\NormalTok{)}

\CommentTok{\# Confusion matrix}
\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{actual =}\NormalTok{ heart\_CP}\SpecialCharTok{$}\NormalTok{ChestPainType,}
           \AttributeTok{predicted =}\NormalTok{ heart\_knn) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{table}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{confusionMatrix}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##       predicted
## actual  TA ATA NAP ASY
##    TA    1  10   7  28
##    ATA   0 103  28  42
##    NAP   0  74  36  93
##    ASY   1  51  15 429
## 
## Overall Statistics
##                                           
##                Accuracy : 0.6198          
##                  95% CI : (0.5875, 0.6513)
##     No Information Rate : 0.6449          
##     P-Value [Acc > NIR] : 0.9469          
##                                           
##                   Kappa : 0.3466          
##                                           
##  Mcnemar's Test P-Value : <2e-16          
## 
## Statistics by Class:
## 
##                      Class: TA Class: ATA Class: NAP Class: ASY
## Sensitivity           0.500000     0.4328    0.41860     0.7247
## Specificity           0.950873     0.8971    0.79928     0.7945
## Pos Pred Value        0.021739     0.5954    0.17734     0.8649
## Neg Pred Value        0.998853     0.8188    0.93007     0.6137
## Prevalence            0.002179     0.2593    0.09368     0.6449
## Detection Rate        0.001089     0.1122    0.03922     0.4673
## Detection Prevalence  0.050109     0.1885    0.22113     0.5403
## Balanced Accuracy     0.725437     0.6649    0.60894     0.7596
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} HEART DISEASE {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} \#}

\CommentTok{\# Best choice of kNN model}
\NormalTok{heart\_knn }\OtherTok{\textless{}{-}} \FunctionTok{knn.cv}\NormalTok{(}\AttributeTok{train =}\NormalTok{ heart\_sc\_HD }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{HeartDisease), }
                          \AttributeTok{cl =}\NormalTok{ heart\_sc\_HD}\SpecialCharTok{$}\NormalTok{HeartDisease, }
                          \AttributeTok{k =} \DecValTok{19}\NormalTok{)}

\CommentTok{\# Confusion matrix }
\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{actual =}\NormalTok{ heart}\SpecialCharTok{$}\NormalTok{HeartDisease, }
           \AttributeTok{predicted =}\NormalTok{ heart\_knn) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{table}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{confusionMatrix}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##             predicted
## actual       Affected Unaffected
##   Affected        397        111
##   Unaffected       85        325
##                                           
##                Accuracy : 0.7865          
##                  95% CI : (0.7585, 0.8126)
##     No Information Rate : 0.5251          
##     P-Value [Acc > NIR] : < 2e-16         
##                                           
##                   Kappa : 0.5707          
##                                           
##  Mcnemar's Test P-Value : 0.07415         
##                                           
##             Sensitivity : 0.8237          
##             Specificity : 0.7454          
##          Pos Pred Value : 0.7815          
##          Neg Pred Value : 0.7927          
##              Prevalence : 0.5251          
##          Detection Rate : 0.4325          
##    Detection Prevalence : 0.5534          
##       Balanced Accuracy : 0.7845          
##                                           
##        'Positive' Class : Affected        
## 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Include the two lines below at the top of the R code to ensure your answer matches the solutions}
\FunctionTok{RNGversion}\NormalTok{(}\StringTok{"4.0.0"}\NormalTok{)}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}
\FunctionTok{typeof}\NormalTok{(heart\_CP}\SpecialCharTok{$}\NormalTok{HeartDisease)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "integer"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create the full classification tree}
\NormalTok{heart\_tree\_CP }\OtherTok{\textless{}{-}} \FunctionTok{rpart}\NormalTok{(ChestPainType }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }
                   \AttributeTok{data =}\NormalTok{ heart\_CP, }
                   \AttributeTok{minsplit =} \DecValTok{2}\NormalTok{, }
                   \AttributeTok{minbucket =} \DecValTok{1}\NormalTok{, }
                   \AttributeTok{cp =} \SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}
                   \AttributeTok{method =} \StringTok{"class"}\NormalTok{)}
\FunctionTok{rpart.plot}\NormalTok{(heart\_tree\_CP, }\AttributeTok{type=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: labs do not fit even at cex 0.15, there may be some overplotting
\end{verbatim}

\includegraphics{FinalProject_files/figure-latex/Tree CHEST PAIN-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Looking at the cp table to find the optimal pruning value:}
\CommentTok{\# simplest tree where xerror \textless{} min(xerror) + min(xstd)}
\FunctionTok{printcp}\NormalTok{(heart\_tree\_CP)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Classification tree:
## rpart(formula = ChestPainType ~ ., data = heart_CP, method = "class", 
##     minsplit = 2, minbucket = 1, cp = -1)
## 
## Variables actually used in tree construction:
##  [1] Age            Cholesterol    ExerciseAngina FastingBS      HeartDisease  
##  [6] MaxHR          Oldpeak        RestingBP      RestingECG     Sex           
## [11] ST_Slope      
## 
## Root node error: 422/918 = 0.45969
## 
## n= 918 
## 
##             CP nsplit rel error  xerror     xstd
## 1   0.10663507      0 1.0000000 1.00000 0.035782
## 2   0.04976303      1 0.8933649 0.89336 0.035321
## 3   0.04502370      2 0.8436019 0.88389 0.035263
## 4   0.01421801      3 0.7985782 0.85071 0.035036
## 5   0.00947867      4 0.7843602 0.85545 0.035071
## 6   0.00710900      5 0.7748815 0.89573 0.035335
## 7   0.00651659     17 0.6872038 0.88626 0.035278
## 8   0.00592417     21 0.6611374 0.88626 0.035278
## 9   0.00568720     23 0.6492891 0.88626 0.035278
## 10  0.00473934     28 0.6208531 0.88863 0.035292
## 11  0.00394945     38 0.5734597 0.89573 0.035335
## 12  0.00379147     42 0.5568720 0.91469 0.035442
## 13  0.00355450     50 0.5236967 0.91943 0.035467
## 14  0.00276461     56 0.5023697 0.92180 0.035479
## 15  0.00236967     62 0.4857820 0.93602 0.035548
## 16  0.00210637    148 0.2796209 0.95024 0.035611
## 17  0.00197472    157 0.2606635 0.95498 0.035631
## 18  0.00189573    194 0.1753555 0.96682 0.035676
## 19  0.00157978    209 0.1445498 0.97867 0.035718
## 20  0.00142180    232 0.1042654 0.97867 0.035718
## 21  0.00118483    237 0.0971564 1.01659 0.035822
## 22  0.00078989    316 0.0023697 1.01659 0.035822
## 23 -1.00000000    319 0.0000000 1.01659 0.035822
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plotcp}\NormalTok{(heart\_tree\_CP)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in sqrt(cp0 * c(Inf, cp0[-length(cp0)])): NaNs produced
\end{verbatim}

\includegraphics{FinalProject_files/figure-latex/Tree CHEST PAIN-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Prune the tree}

\NormalTok{p\_heart\_tree\_CP}\OtherTok{\textless{}{-}} \FunctionTok{prune}\NormalTok{(heart\_tree\_CP, }\AttributeTok{cp=} \FloatTok{0.046}\NormalTok{)}


\CommentTok{\# Plot the pruned tree}

\FunctionTok{rpart.plot}\NormalTok{(p\_heart\_tree\_CP, }
           \AttributeTok{type=}\DecValTok{5}\NormalTok{, }
           \AttributeTok{extra =} \DecValTok{101}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{FinalProject_files/figure-latex/CHEST PAIN Prune Tree-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Display the confusion matrix}
\NormalTok{pheart\_tree\_pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(}\AttributeTok{object =}\NormalTok{ p\_heart\_tree\_CP,}
                         \AttributeTok{newdata =}\NormalTok{ heart\_CP, }
                         \AttributeTok{type =} \StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{)}

\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{actual =}\NormalTok{ heart\_CP}\SpecialCharTok{$}\NormalTok{ChestPainType, }
           \AttributeTok{predicted =}\NormalTok{ pheart\_tree\_pred) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{table}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{confusionMatrix}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##       predicted
## actual  TA ATA NAP ASY
##    TA    0   7  19  20
##    ATA   0 114  35  24
##    NAP   0  75  56  72
##    ASY   0  52  52 392
## 
## Overall Statistics
##                                           
##                Accuracy : 0.6122          
##                  95% CI : (0.5798, 0.6439)
##     No Information Rate : 0.5534          
##     P-Value [Acc > NIR] : 0.0001788       
##                                           
##                   Kappa : 0.3654          
##                                           
##  Mcnemar's Test P-Value : 5.916e-14       
## 
## Statistics by Class:
## 
##                      Class: TA Class: ATA Class: NAP Class: ASY
## Sensitivity                 NA     0.4597     0.3457     0.7717
## Specificity            0.94989     0.9119     0.8056     0.7463
## Pos Pred Value              NA     0.6590     0.2759     0.7903
## Neg Pred Value              NA     0.8201     0.8517     0.7251
## Prevalence             0.00000     0.2702     0.1765     0.5534
## Detection Rate         0.00000     0.1242     0.0610     0.4270
## Detection Prevalence   0.05011     0.1885     0.2211     0.5403
## Balanced Accuracy           NA     0.6858     0.5756     0.7590
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Include the two lines below at the top of the R code to ensure your answer matches the solutions}
\FunctionTok{RNGversion}\NormalTok{(}\StringTok{"4.0.0"}\NormalTok{)}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}


\CommentTok{\# Create the full classification tree}
\NormalTok{heart\_tree2 }\OtherTok{\textless{}{-}} \FunctionTok{rpart}\NormalTok{(HeartDisease }\SpecialCharTok{\textasciitilde{}}\NormalTok{ .,}
                   \AttributeTok{data =}\NormalTok{ heart,}
                   \AttributeTok{minsplit =} \DecValTok{2}\NormalTok{,}
                   \AttributeTok{minbucket =} \DecValTok{1}\NormalTok{,}
                   \AttributeTok{cp =} \SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}
                   \AttributeTok{method =} \StringTok{"class"}\NormalTok{)}
\FunctionTok{rpart.plot}\NormalTok{(heart\_tree2, }\AttributeTok{type=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: labs do not fit even at cex 0.15, there may be some overplotting
\end{verbatim}

\includegraphics{FinalProject_files/figure-latex/HEART DISEASE Tree-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Looking at the cp table to find the optimal pruning value:}
\CommentTok{\# simplest tree where xerror \textless{} min(xerror) + min(xstd)}
\FunctionTok{printcp}\NormalTok{(heart\_tree2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Classification tree:
## rpart(formula = HeartDisease ~ ., data = heart, method = "class", 
##     minsplit = 2, minbucket = 1, cp = -1)
## 
## Variables actually used in tree construction:
##  [1] Age            ChestPainType  Cholesterol    ExerciseAngina FastingBS     
##  [6] MaxHR          Oldpeak        RestingBP      RestingECG     Sex           
## [11] ST_Slope      
## 
## Root node error: 410/918 = 0.44662
## 
## n= 918 
## 
##             CP nsplit rel error  xerror     xstd
## 1   0.58292683      0  1.000000 1.00000 0.036738
## 2   0.04878049      1  0.417073 0.41707 0.028771
## 3   0.01829268      2  0.368293 0.38537 0.027895
## 4   0.01463415      4  0.331707 0.37317 0.027540
## 5   0.00731707      6  0.302439 0.36341 0.027249
## 6   0.00609756     13  0.251220 0.36829 0.027396
## 7   0.00487805     15  0.239024 0.36098 0.027175
## 8   0.00365854     21  0.209756 0.36585 0.027323
## 9   0.00325203     28  0.182927 0.38780 0.027965
## 10  0.00243902     34  0.160976 0.39024 0.028034
## 11  0.00162602     57  0.104878 0.39024 0.028034
## 12  0.00146341     63  0.095122 0.41463 0.028706
## 13  0.00121951     77  0.070732 0.46585 0.029997
## 14  0.00097561    118  0.017073 0.46829 0.030055
## 15  0.00081301    123  0.012195 0.47805 0.030282
## 16 -1.00000000    137  0.000000 0.47805 0.030282
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plotcp}\NormalTok{(heart\_tree2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in sqrt(cp0 * c(Inf, cp0[-length(cp0)])): NaNs produced
\end{verbatim}

\includegraphics{FinalProject_files/figure-latex/HEART DISEASE Tree-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Prune the tree}

\NormalTok{p\_heart\_tree2}\OtherTok{\textless{}{-}} \FunctionTok{prune}\NormalTok{(heart\_tree2, }\AttributeTok{cp=} \FloatTok{0.0182927}\NormalTok{)}


\CommentTok{\# Plot the pruned tree}

\FunctionTok{rpart.plot}\NormalTok{(p\_heart\_tree2,}
           \AttributeTok{type=}\DecValTok{5}\NormalTok{,}
           \AttributeTok{extra =} \DecValTok{101}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{FinalProject_files/figure-latex/HEART DISEASE Tree-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Display the confusion matrix}
\NormalTok{pheart\_tree\_pred2 }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(}\AttributeTok{object =}\NormalTok{ p\_heart\_tree2,}
                         \AttributeTok{newdata =}\NormalTok{ heart,}
                         \AttributeTok{type =} \StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{)}

\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{actual =}\NormalTok{ heart}\SpecialCharTok{$}\NormalTok{HeartDisease,}
           \AttributeTok{predicted =}\NormalTok{ pheart\_tree\_pred2) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{table}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{confusionMatrix}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##             predicted
## actual       Affected Unaffected
##   Affected        463         45
##   Unaffected      106        304
##                                           
##                Accuracy : 0.8355          
##                  95% CI : (0.8099, 0.8589)
##     No Information Rate : 0.6198          
##     P-Value [Acc > NIR] : < 2.2e-16       
##                                           
##                   Kappa : 0.6624          
##                                           
##  Mcnemar's Test P-Value : 1.046e-06       
##                                           
##             Sensitivity : 0.8137          
##             Specificity : 0.8711          
##          Pos Pred Value : 0.9114          
##          Neg Pred Value : 0.7415          
##              Prevalence : 0.6198          
##          Detection Rate : 0.5044          
##    Detection Prevalence : 0.5534          
##       Balanced Accuracy : 0.8424          
##                                           
##        'Positive' Class : Affected        
## 
\end{verbatim}

\end{document}
